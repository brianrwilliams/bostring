\section{Global sections of the factorization algebra} 

%First, consider the elliptic complex
%\ben
%\Omega^{0,*}(\Sigma ; \cV)
%\een
%of $(0,*)$-forms with values in $\cV$. The differential is simply the $\dbar$ operator. We consider its shift $\Omega^{0,*}(\Sigma ; \cV)[-1]$ as an abelian local dg Lie algebra. In this way, the associated cotangent theory of the elliptic complex is defined as 
%\ben
%T^{*}[-1] (\Omega^{0,*}(\Sigma ; \cV)) = \Omega^{0,*}(\Sigma ; V) \oplus \Omega^{1,*}(\Sigma ; T_\Sigma^{1,0}) \Omega^{1,*}(\Sigma ; \cV^\vee) \oplus \ .
%\een 
%We write the fields as $\gamma \in \Omega^{0,*}(\Sigma ; \cV)$ for the base direction and $\beta \in \Omega^{1,*}(\Sigma ; \cV^\vee)$ for the fiber direction. With this notation, the action functional is defined as
%\ben
%S (\beta, \gamma) = \int_\Sigma \<\beta, \dbar \gamma\>_\cV
%\een
%where $\<-,-\>_\cV$ denotes the evaluation pairing between $\cV$ and its dual. This theory is called the $\beta\gamma$ (or sometimes $\beta \gamma-bc$ \owen{what are the $bc$ fields?}) system with values in $\cV$. This is a free field theory and hence has a natural quantization. We will denote the factorization algebra of quantum observables on $\Sigma$ by $\Obs^{q}_{\cV}$. 

\brian{Discuss relationship to conformal blocks??}

We wish to write the global observables of the holomorphic string in terms of the cohomology of natural holomorphic vector bundles on the Riemann surface. 

In Section \ref{rmk:bcbg} we have introduced the $bc\beta\gamma$ system defined on an Riemann surface $\Sigma$. 
This theory is free, and hence admits a canonical BV quantization.
Denote by $\Obs^{\q}_{free}$ be the corresponding factorization algebra.
In fact, Proposition 8.1.4.1 in \cite{fact1}, there is an isomorphism of the cohomology of the global observables of this factorization algebra:
\ben
H^*\left(\Obs^\q_{free}(\Sigma)\right) \cong \det \left(H^*(\Sigma ; \sO_\Sigma) \right)^{\tensor \dim(V)} \tensor \det \left(H^*(\Sigma ; T_\Sigma^{1,0})\right)^{-1} [d(\Sigma)] 
\een
where 
\ben
d(\Sigma) = \dim (V) \cdot \left(\dim H^0(\Sigma ; \sO_\Sigma) + \dim H^1(\Sigma ; \sO_\Sigma)\right) + \dim(H^0(\Sigma ; T_\Sigma^{1,0})) - \dim(H^1(\Sigma ; T_\Sigma^{1,0}))
\een

%\begin{lem}[\cite{fact1} Proposition 8.1.4.1]
%\label{lem bg global obs} 
%Let $b_i = \dim H^i (\Sigma ; \cV)$. The cohomology of the global observables of the $\beta\gamma$ system with values in $\cV$ is given by
%\ben
%H^*\left(\Obs^q_{\cV}(\Sigma)\right) \cong \det \left(H^*(\Sigma ; \cV) \right) [d(\cV)] 
%\een
%where $d(\cV) = -b_0 - b_1$. 
%\end{lem}

\owen{It would be good here to point out the GRR argument for identifying the first Chern class of this determinant line bundle. We can then point out that it resonates with our computation on the formal disk and give a reminder that this is a manifestation of ``Virasoro uniformization.'' This then leads into the string case: the holomorphic vector fields (rather the free $bc$ system) also contribute a determinant line (we should include that computation) and we can ask when those determinant lines tensor to a trivial line. Note that deforming the action from free $bc\beta\gamma$ system to holomorphic bosonic string doesn't affect the line bundles, since those are continuous parameters and Chern classes are discrete.}

\subsection{The holomorphic string on a Riemann surface}

We have constructed the quantization of the holomorphic string on $\CC$ and derived from its factorization algebra a vertex algebra. 
The only anomaly cancellation condition to have such a quantization was the restriction that the target be $13$ complex dimensional. 
Here, we see why our anomaly calculation above is actually enough to show the existence of a quantization on an arbitrary Riemann surface. 
It is clear that in the case of a flat target that the only anomaly is purely a functional of the $c$-fields (holomorphic vector fields on $\Sigma$).
Hence, the part of the deformation complex that contains the anomaly is:
\ben
\Omega^{*}_\Sigma \tensor_{D_\Sigma} \cred^*(J \Omega^{0,*}(\Sigma ; T_\Sigma)) [2] .
\een
Now Proposition 5.3 of \ref{bw} shows that this sheaf of complexes is quasi-isomorphic to the constant sheaf $\CC[-1]$ concentrated in degree $+1$. 
Now, a main result of the Costello-Gwilliam formulation of BV quantization is that anomalies are {\em local}: the anomaly computed on an open set $U \subset \Sigma$ is equal to the anomaly of the theory restricted to $U \subset \Sigma$. 
In particular, since the anomaly is an element of the constant sheaf, it suffices to compute the anomaly on an arbitrary open in the Riemann surface, which we may take to be $U \cong \CC$ with its flat metric. 
This is precisely the context in which we computed the anomaly in Section \ref{sec:quantization}.

Thus, just as in the case of a flat source, a quantization of the holomorphic string exists on any Riemann surface provided $\dim_{\CC}(V) = 13$. 
Now, there is a moduli of quantizations.
Indeed, by the calculation of the $\CC^\times_{\rm cot}$-weight zero component of the deformation complex in Section \ref{sec:moduli} we see that the space of deformations for quantizations at one loop are a torsor for the vector space
\ben
H^0(\Sigma) \tensor \Omega^1(V) \oplus H^1(\Sigma) \tensor \Omega^2_{cl}(V) .
\een 
Thus, the space of deformations is given by a space of continuous parameters and hence will not change the class of the line bundle of global observables. 
In conclusion, we are free to choose any one-loop quantization; this will not affect the cohomology of the global observables. 

\subsection{}

Now, let us consider the global observables of the bosonic string $\Obs^\q(\Sigma)$. 
There is a spectral sequence converging to the cohomology of the global observables $H^*\Obs^\q(\Sigma)$ with $E_2$ page given by the cohomology of the global observables of the $bc\beta \gamma$ system which we have already computed:
\bestar
E_2 & \cong & \det\left(H^*(\Sigma ; \cT_\Sigma[1])\right) \tensor \det \left(H^*(\Sigma ; \cO_\Sigma)^{\oplus 13}\right) \\
& \cong & \det \left(H^1(\Sigma ; \cT_\Sigma) \right) \tensor \det \left(H^0(\Sigma ; \cT_\Sigma)\right)^{-1} \tensor \det \left(H^0(\Sigma ; K_{\Sigma}) \right)^{-13}
\eestar
where we have used the fact that $H^0(\Sigma ; \cO) \cong \CC$ for any $\Sigma$. 

Let $\Sigma_{g}$ be a surface of genus $g$. Then for $g=1$ the above simplifies to
\ben
\det \left(H^1(\Sigma_1 ; \cT_{\Sigma_1})\right) \tensor \det \left(H^0(\Sigma_1 ; K) \right)^{-14} .
\een 
If $g \geq 2$ one has
\ben
\det \left(H^1(\Sigma_1 ; \cT_{\Sigma_1})\right) \tensor \det \left(H^0(\Sigma_1 ; K) \right)^{-13} .
\een
It is clear that the spectral sequence degenerates at this page. Thus the above expressions give the global observables for the holomorphic string for genus $g =1$ and $g \geq 2$, respectively. 

\section{The string partition function on an elliptic curve}

We will evaluate the partition function of the theory on an elliptic curve. 
For $\tau \in \HH$, the upper half plane, we can write an elliptic curve as a quotient of $\CC$ by the lattice $\ZZ + \tau \ZZ$
\ben
E_\tau = \CC / (\ZZ + \tau \ZZ) .
\een 
Let $\d^2 z = \d z \d \zbar$ be the volume form on $\CC$ which descends to one on $E_\tau$ that we denote by the same name. 

We have already discussed the gauge fixing operator and constructed the heat kernel that regularizes the operator $\dbar^{-1}$ on $\CC$. 
We can make the same choice of gauge fixing operator, namely $\dbar^*$, on the elliptic curve $E_\tau$ and hence we obtain a heat kernel for the operator $e^{-t D^{E_\tau}}$ where $D^{E_\tau}$ is the commutator $[\dbar, \dbar^*] = \frac{1}{2} \Delta$ on $E_\tau$. 
Explicitly, the heat kernel of the operator $e^{-t D^{E_\tau}}$ on the elliptic curve $E_\tau$ pulled back to the universal cover $\CC$ along the $\CC \to E_\tau$ is of the form
\ben 
K^{E_\tau}_t (z,w) = \sum_{\lambda \in \ZZ + \tau \ZZ} \frac{1}{2\pi t} e^{-|z-w + \lambda|^2 / 2 t} (\d z - \d w) (\d \zbar - \d \wbar ) .
\een
From $K_t^{E_\tau}$ we obtain the propagator $P_{\ell < L}^{E_\tau} = \dbar^* \int_{\ell}^L e^{-t D^{E_\tau}} \d t$ just as above. 

This propagator regularizes the operator $\dbar^{-1}$ on $E_\tau$. 
The full propagator of the holomorphic string on $E_\tau$ has one component coming from the pairing between the fields $\beta$ and $\gamma$ and another component coming from the pairing between the fields $b$ and $c$. 
Since $\gamma$ is a section of the trivial vector bundle labeled by the vector space $V$, the first term in the full propagator is of the form $P_{\ell < L}^{E_\tau} \tensor \frac{1}{2} (\id_V + \id_{V^*})$.
Now, since the tangent bundle is trivial on an elliptic curve we can choose a canonical framing and write the second piece of the propagator describing the pairing between $b$ and $c$ as $P_{\ell < L}^{E_\tau} \tensor (\partial_z \tensor \partial_z^\vee + \partial_z^\vee \tensor \partial_z)$ where $\partial_z, \partial_z^\vee$ denote the canonical framing of $T_{E_\tau}, T_{E_\tau}*$ respectively. 

Just as in the case of the calculation of the anomaly, the propagator will is a sum over wheels that are functionals of the $c$-fields. 
Unlike the case of the anomaly, the internal edges of the wheels are all labeled by the propagator. 
The vertices are labeled by the interaction terms which have two types: a $\beta c \gamma$-type interaction and a $bcc$-type interaction. 
Thus, the partition function splits up into a sum of two types of diagrams (\ref{diagram:partition}): A) all input legs labeled by the fields $c$ with each internal edge labeled by the $\beta\gamma$ propagator $P_{\ell < L}^{E_\tau} \tensor \frac{1}{2} (\id_V + \id_{V^*})$, and B) all input legs labeled by the fields $c$ with each internal edge labeled by the $bc$ propagator $P_{\ell < L}^{E_\tau} \tensor (\partial_z \tensor \partial_z^\vee + \partial_z^\vee \tensor \partial_z)$. 
\brian{draw diagrams}

For $j \geq 1$ let $A^{E_\tau}_j$ (respectively $B^{E_\tau}_j$) be the weight of the graph of type $A$ (respectively $B$) with $j$ incoming legs.

\begin{lem} Consider the weight of the tadpole diagram of type $A$, $A^{E_\tau}_1(c)$. Evaluated on the generator $c = \d \zbar \partial_z$ one has
\ben
A_1^{E_\tau} (\zbar \partial_z) = \# (- 2) \cdot (13) \cdot E_2^*(\tau) 
\een
\brian{WORK OUT FACTOR} .
Similarly, the weight of the tadpole diagram of type $B$ evaluated on the generator is given by
\ben
B_1^{E_\tau} (\zbar \partial_z) = \# (2) \cdot E_2^*(\tau) .
\een 
\end{lem}

We obtain the weight of the diagrams with two or more vertices by the following inductive formula. 

\begin{lem} One has $\partial_\tau A^{E_\tau}_{j} = \# A^{E_\tau}_{j+1}$ and $\partial_\tau B_j^{E_\tau} = \# B_{j+1}^{E_\tau}$.
\end{lem}

We conclude the following. 

\begin{prop} The partition function of the holomorphic bosonic string is the formal power series expansion of the holomorphic function $-24 \log \eta (t)$ near the point $t = \tau \in \HH$. 
\end{prop}

\owen{If possible, it would be cool to explain how one can extract the differential equations (=flat connection) governing the partition function from our construction. This might be too hard right now \dots}
